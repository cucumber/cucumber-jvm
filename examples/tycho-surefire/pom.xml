<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>io.cucumber</groupId>
        <artifactId>cucumber-examples</artifactId>
        <version>3.0.0-SNAPSHOT</version>
    </parent>

    <artifactId>tycho-surefire</artifactId>
    <packaging>pom</packaging>
    <name>Examples: Tycho</name>

    <modules>
        <module>tycho-surefire-example</module>
        <module>tycho-surefire-example-target</module>
        <module>tycho-surefire-example-test</module>
    </modules>
    
    <properties>
        <tycho.version>0.23.1</tycho.version>
        <surefire.plugin.version>2.18.1</surefire.plugin.version>
        <target.classifier>tycho-surefire</target.classifier>
    </properties>
    
    <dependencies>
		<dependency>
		  <groupId>org.eclipse.tycho</groupId>
		  <artifactId>tycho-surefire</artifactId>
		  <version>${tycho.version}</version>
		  <type>pom</type>
		  <exclusions>
			  <exclusion>
				  <groupId>junit</groupId>
				  <artifactId>junit</artifactId>
			  </exclusion>
		  </exclusions>
        </dependency>
    </dependencies>
    
    <build>
        <sourceDirectory>src</sourceDirectory>
        
        <plugins>
	        <plugin>
		      <groupId>org.eclipse.tycho</groupId>
		      <artifactId>tycho-maven-plugin</artifactId>
		      <version>${tycho.version}</version>
		      <extensions>true</extensions>
		    </plugin>
		    
		    <plugin>
		        <groupId>org.eclipse.tycho</groupId>
		        <artifactId>tycho-packaging-plugin</artifactId>
		        <version>${tycho.version}</version>
	        </plugin>
	        
            <plugin>
		        <groupId>org.eclipse.tycho</groupId>
		        <artifactId>tycho-p2-plugin</artifactId>
		        <version>${tycho.version}</version>
		        <executions>
		          <execution>
		            <id>default-p2-metadata-default</id>
		            <phase>package</phase>
		            <goals>
		              <goal>p2-metadata-default</goal>
		            </goals>
		          </execution>
		          <execution>
		            <id>default-update-local-index</id>
		            <phase>install</phase>
		            <goals>
		              <goal>update-local-index</goal>
		            </goals>
		          </execution>
		        </executions>
		    </plugin>
		    
		    <plugin>
				 <groupId>org.eclipse.tycho</groupId>
				 <artifactId>tycho-compiler-plugin</artifactId>
				 <version>${tycho.version}</version>
				 <configuration>
					 <source>1.8</source>
					 <target>1.8</target>
				 </configuration>
			</plugin>
 
		    <plugin>
                <groupId>org.eclipse.tycho</groupId>
                <artifactId>target-platform-configuration</artifactId>
                <version>${tycho.version}</version>
                <configuration>
                    <target>
                        <artifact>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>tycho-surefire-example-target</artifactId>
                            <version>${project.version}</version>
                            <classifier>${target.classifier}</classifier>
                        </artifact>
                    </target>
                    <environments>
                        <environment>
                            <os>win32</os>
                            <ws>win32</ws>
                            <arch>x86_64</arch>
                        </environment>
                        <environment>
                            <os>linux</os>
                            <ws>gtk</ws>
                            <arch>x86_64</arch>
                        </environment>
                    </environments>
                </configuration>
            </plugin>
            
            <plugin>
                <groupId>org.eclipse.tycho</groupId>
                <artifactId>tycho-surefire-plugin</artifactId>
                <version>${tycho.version}</version>
                <executions>
                  <execution>
                    <id>default-test</id>
                    <phase>integration-test</phase>
                    <goals>
                      <goal>test</goal>
                    </goals>
                    <configuration>
                      <useUIHarness>false</useUIHarness>
                      <includes>
                        <include>**/*Test.*</include>
                        <include>**/Test*.*</include>
                      </includes>
                      <systemProperties>
                        <java.awt.headless>true</java.awt.headless>
                      </systemProperties>
                      <providerHint>junit4</providerHint>
                    </configuration>
                  </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project>
